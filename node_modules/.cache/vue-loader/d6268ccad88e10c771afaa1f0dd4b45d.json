{"remainingRequest":"/Users/kornilov/thevoyager/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/kornilov/thevoyager/frontend/src/components/Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/kornilov/thevoyager/frontend/src/components/Login.vue","mtime":1591891415488},{"path":"/Users/kornilov/thevoyager/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/kornilov/thevoyager/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/kornilov/thevoyager/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/kornilov/thevoyager/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICdheGlvcycKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnTG9naW4nLAogIGRhdGEgKCkgewogICAgcmV0dXJuIHsKICAgICAgdXNlcm5hbWU6ICcnLAogICAgICBwYXNzd29yZDogJycKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGF1dGhlbnRpY2F0ZSAoKSB7CiAgICAgIGNvbnN0IHBheWxvYWQgPSB7CiAgICAgICAgdXNlcm5hbWU6IHRoaXMudXNlcm5hbWUsCiAgICAgICAgcGFzc3dvcmQ6IHRoaXMucGFzc3dvcmQKICAgICAgfQogICAgICBheGlvcy5wb3N0KHRoaXMuJHN0b3JlLnN0YXRlLmVuZHBvaW50cy5vYnRhaW5KV1QsIHBheWxvYWQpCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3VwZGF0ZVRva2VuJywgcmVzcG9uc2UuZGF0YS50b2tlbikKICAgICAgICAgIC8vIGdldCBhbmQgc2V0IGF1dGggdXNlcgogICAgICAgICAgY29uc3QgYmFzZSA9IHsKICAgICAgICAgICAgYmFzZVVSTDogdGhpcy4kc3RvcmUuc3RhdGUuZW5kcG9pbnRzLmJhc2VVcmwsCiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAvLyBTZXQgeW91ciBBdXRob3JpemF0aW9uIHRvICdKV1QnLCBub3QgQmVhcmVyISEhCiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEpXVCAke3RoaXMuJHN0b3JlLnN0YXRlLmp3dH1gLAogICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgICAgICAgICAgfSwKICAgICAgICAgICAgeGhyRmllbGRzOiB7CiAgICAgICAgICAgICAgd2l0aENyZWRlbnRpYWxzOiB0cnVlCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIC8vIEV2ZW4gdGhvdWdoIHRoZSBhdXRoZW50aWNhdGlvbiByZXR1cm5lZCBhIHVzZXIgb2JqZWN0IHRoYXQgY2FuIGJlCiAgICAgICAgICAvLyBkZWNvZGVkLCB3ZSBmZXRjaCBpdCBhZ2Fpbi4gVGhpcyB3YXkgd2UgYXJlbid0IHN1cGVyIGRlcGVuZGFudCBvbgogICAgICAgICAgLy8gSldUIGFuZCBjYW4gcGx1ZyBpbiBzb21ldGhpbmcgZWxzZS4KICAgICAgICAgIGNvbnN0IGF4aW9zSW5zdGFuY2UgPSBheGlvcy5jcmVhdGUoYmFzZSkKICAgICAgICAgIGF4aW9zSW5zdGFuY2UoewogICAgICAgICAgICB1cmw6ICcvdXNlcnMvJywKICAgICAgICAgICAgbWV0aG9kOiAncG9zdCcsCiAgICAgICAgICAgIHBhcmFtczoge30KICAgICAgICAgIH0pCiAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0QXV0aFVzZXInLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBhdXRoVXNlcjogcmVzcG9uc2UuZGF0YSwgaXNBdXRoZW50aWNhdGVkOiB0cnVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgKQogICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgICAgIG5hbWU6ICdIb21lJwogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0pCiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcikKICAgICAgICAgIGNvbnNvbGUuZGVidWcoZXJyb3IpCiAgICAgICAgICBjb25zb2xlLmRpcihlcnJvcikKICAgICAgICB9KQogICAgfQogIH0KfQoK"},{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <b-container>\n    <b-row class =\"justify-content-md-center\">\n      <b-col lg = \"4\" >\n        <div class = \"login-window\">\n          <b-form >\n            <b-input-group prepend=\"@\" class=\"mb-2 mr-sm-2 mb-sm-0\">\n              <b-input id=\"input-username\" placeholder=\"Логин\" v-model=\"username\"></b-input>\n            </b-input-group>\n            <br>\n            <b-input-group type=\"password\" class=\"mb-2 mr-sm-2 mb-sm-0\">\n              <b-input id=\"input-password\" type=\"password\" placeholder=\"Пароль\" v-model=\"password\"></b-input>\n            </b-input-group>\n            <br>\n            <b-button\n              @click.prevent=\"authenticate\"\n              type=\"submit\">\n              Войти\n            </b-button>\n          </b-form>\n        </div>\n      </b-col>\n    </b-row>\n  </b-container>\n</template>\n\n<script>\nimport axios from 'axios'\n\nexport default {\n  name: 'Login',\n  data () {\n    return {\n      username: '',\n      password: ''\n    }\n  },\n  methods: {\n    authenticate () {\n      const payload = {\n        username: this.username,\n        password: this.password\n      }\n      axios.post(this.$store.state.endpoints.obtainJWT, payload)\n        .then((response) => {\n          this.$store.commit('updateToken', response.data.token)\n          // get and set auth user\n          const base = {\n            baseURL: this.$store.state.endpoints.baseUrl,\n            headers: {\n              // Set your Authorization to 'JWT', not Bearer!!!\n              Authorization: `JWT ${this.$store.state.jwt}`,\n              'Content-Type': 'application/json'\n            },\n            xhrFields: {\n              withCredentials: true\n            }\n          }\n          // Even though the authentication returned a user object that can be\n          // decoded, we fetch it again. This way we aren't super dependant on\n          // JWT and can plug in something else.\n          const axiosInstance = axios.create(base)\n          axiosInstance({\n            url: '/users/',\n            method: 'post',\n            params: {}\n          })\n            .then((response) => {\n              this.$store.commit('setAuthUser',\n                {\n                  authUser: response.data, isAuthenticated: true\n                }\n              )\n              this.$router.push({\n                name: 'Home'\n              })\n            })\n        })\n        .catch((error) => {\n          console.log(error)\n          console.debug(error)\n          console.dir(error)\n        })\n    }\n  }\n}\n\n</script>\n\n<style>\n</style>\n"]}]}